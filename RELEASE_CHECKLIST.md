# 发布检查清单

## 📋 发布前检查

### ✅ 代码质量
- [ ] 所有测试通过 (`npm test`)
- [ ] 代码检查通过 (`npm run lint`)
- [ ] 类型检查通过 (`npm run type-check`)
- [ ] 构建成功 (`npm run build`)
- [ ] 代码审查完成

### ✅ Git状态
- [ ] 在正确的分支上 (main/master)
- [ ] 没有未提交的更改
- [ ] 所有更改已推送到远程仓库
- [ ] 分支是最新的

### ✅ 文档更新
- [ ] README.md 是最新的
- [ ] API文档已更新
- [ ] 示例代码正常工作
- [ ] 更新日志已更新

### ✅ 包配置
- [ ] package.json 中的版本号正确
- [ ] 包名称正确
- [ ] 描述信息准确
- [ ] 关键词合适
- [ ] 许可证信息正确
- [ ] 作者信息正确

### ✅ npm配置
- [ ] 已登录npm (`npm whoami`)
- [ ] 有发布权限
- [ ] 包名可用
- [ ] 注册表配置正确

## 🚀 发布流程

### 1. 选择发布类型
```bash
# 补丁版本 (Bug修复)
npm run publish:patch

# 次版本 (新功能)
npm run publish:minor

# 主版本 (破坏性变更)
npm run publish:major

# 快速发布 (补丁版本)
npm run publish:quick

# 试运行 (不实际发布)
npm run publish:dry-run
```

### 2. 验证发布
- [ ] 检查npm包页面
- [ ] 测试安装新版本
- [ ] 验证功能正常
- [ ] 检查Git标签

### 3. 发布后任务
- [ ] 更新GitHub Release
- [ ] 通知团队成员
- [ ] 更新相关文档
- [ ] 监控错误报告

## 🎯 版本管理

### 语义化版本控制
- **主版本 (major)**: 不兼容的API修改
- **次版本 (minor)**: 向下兼容的功能性新增
- **修订版本 (patch)**: 向下兼容的问题修正

### 版本号示例
```
1.0.0 → 1.0.1  (patch)
1.0.0 → 1.1.0  (minor)
1.0.0 → 2.0.0  (major)
```

## 🔐 安全发布

### npm安全
- [ ] 运行 `npm audit` 检查安全漏洞
- [ ] 更新有安全问题的依赖
- [ ] 使用 `npm audit fix` 修复问题

### 发布权限
- [ ] 确认有包的发布权限
- [ ] 检查组织权限设置
- [ ] 验证访问令牌有效

## 📊 质量保证

### 测试覆盖
- [ ] 单元测试覆盖率 > 80%
- [ ] 集成测试通过
- [ ] 端到端测试通过
- [ ] 性能测试通过

### 兼容性
- [ ] 支持目标Node.js版本
- [ ] 支持目标浏览器版本
- [ ] TypeScript类型定义正确
- [ ] 向后兼容性验证

## 🚨 常见问题

### 发布失败
1. 检查npm登录状态
2. 验证包名可用性
3. 确认发布权限
4. 检查网络连接

### 版本冲突
1. 检查本地版本号
2. 同步远程仓库
3. 解决合并冲突
4. 重新发布

### 构建失败
1. 检查依赖版本
2. 清理构建缓存
3. 更新Node.js版本
4. 检查配置文件

## 📞 紧急联系

如果发布过程中遇到问题：

1. **立即停止发布流程**
2. **检查错误日志**
3. **联系维护团队**
4. **准备回滚方案**

### 回滚步骤
```bash
# 删除本地标签
git tag -d v1.0.0

# 重置到上一个提交
git reset --hard HEAD~1

# 强制推送
git push --force origin main

# 从npm撤回包 (如果已发布)
npm unpublish @your-org/sso-auth-ui@1.0.0
```

---

**记住**: 发布前请仔细检查每一项，确保发布的质量和稳定性。 